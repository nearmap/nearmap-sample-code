{"version":3,"file":"vector-labels.js","mappings":"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","sources":["webpack:///./vector-labels.js"],"sourcesContent":["import GeoJSON from '../src/ol/format/GeoJSON.js';\nimport Map from '../src/ol/Map.js';\nimport View from '../src/ol/View.js';\nimport {\n  Circle as CircleStyle,\n  Fill,\n  Stroke,\n  Style,\n  Text,\n} from '../src/ol/style.js';\nimport {OSM, Vector as VectorSource} from '../src/ol/source.js';\nimport {Tile as TileLayer, Vector as VectorLayer} from '../src/ol/layer.js';\n\nlet openSansAdded = false;\n\nconst myDom = {\n  points: {\n    text: document.getElementById('points-text'),\n    align: document.getElementById('points-align'),\n    baseline: document.getElementById('points-baseline'),\n    rotation: document.getElementById('points-rotation'),\n    font: document.getElementById('points-font'),\n    weight: document.getElementById('points-weight'),\n    size: document.getElementById('points-size'),\n    height: document.getElementById('points-height'),\n    offsetX: document.getElementById('points-offset-x'),\n    offsetY: document.getElementById('points-offset-y'),\n    color: document.getElementById('points-color'),\n    outline: document.getElementById('points-outline'),\n    outlineWidth: document.getElementById('points-outline-width'),\n    maxreso: document.getElementById('points-maxreso'),\n  },\n  lines: {\n    text: document.getElementById('lines-text'),\n    align: document.getElementById('lines-align'),\n    baseline: document.getElementById('lines-baseline'),\n    rotation: document.getElementById('lines-rotation'),\n    font: document.getElementById('lines-font'),\n    weight: document.getElementById('lines-weight'),\n    placement: document.getElementById('lines-placement'),\n    maxangle: document.getElementById('lines-maxangle'),\n    overflow: document.getElementById('lines-overflow'),\n    size: document.getElementById('lines-size'),\n    height: document.getElementById('lines-height'),\n    offsetX: document.getElementById('lines-offset-x'),\n    offsetY: document.getElementById('lines-offset-y'),\n    color: document.getElementById('lines-color'),\n    outline: document.getElementById('lines-outline'),\n    outlineWidth: document.getElementById('lines-outline-width'),\n    maxreso: document.getElementById('lines-maxreso'),\n  },\n  polygons: {\n    text: document.getElementById('polygons-text'),\n    align: document.getElementById('polygons-align'),\n    baseline: document.getElementById('polygons-baseline'),\n    rotation: document.getElementById('polygons-rotation'),\n    font: document.getElementById('polygons-font'),\n    weight: document.getElementById('polygons-weight'),\n    placement: document.getElementById('polygons-placement'),\n    maxangle: document.getElementById('polygons-maxangle'),\n    overflow: document.getElementById('polygons-overflow'),\n    size: document.getElementById('polygons-size'),\n    height: document.getElementById('polygons-height'),\n    offsetX: document.getElementById('polygons-offset-x'),\n    offsetY: document.getElementById('polygons-offset-y'),\n    color: document.getElementById('polygons-color'),\n    outline: document.getElementById('polygons-outline'),\n    outlineWidth: document.getElementById('polygons-outline-width'),\n    maxreso: document.getElementById('polygons-maxreso'),\n  },\n};\n\nconst getText = function (feature, resolution, dom) {\n  const type = dom.text.value;\n  const maxResolution = dom.maxreso.value;\n  let text = feature.get('name');\n\n  if (resolution > maxResolution) {\n    text = '';\n  } else if (type == 'hide') {\n    text = '';\n  } else if (type == 'shorten') {\n    text = text.trunc(12);\n  } else if (\n    type == 'wrap' &&\n    (!dom.placement || dom.placement.value != 'line')\n  ) {\n    text = stringDivider(text, 16, '\\n');\n  }\n\n  return text;\n};\n\nconst createTextStyle = function (feature, resolution, dom) {\n  const align = dom.align.value;\n  const baseline = dom.baseline.value;\n  const size = dom.size.value;\n  const height = dom.height.value;\n  const offsetX = parseInt(dom.offsetX.value, 10);\n  const offsetY = parseInt(dom.offsetY.value, 10);\n  const weight = dom.weight.value;\n  const placement = dom.placement ? dom.placement.value : undefined;\n  const maxAngle = dom.maxangle ? parseFloat(dom.maxangle.value) : undefined;\n  const overflow = dom.overflow ? dom.overflow.value == 'true' : undefined;\n  const rotation = parseFloat(dom.rotation.value);\n  if (dom.font.value == \"'Open Sans'\" && !openSansAdded) {\n    const openSans = document.createElement('link');\n    openSans.href = 'https://fonts.googleapis.com/css?family=Open+Sans';\n    openSans.rel = 'stylesheet';\n    document.getElementsByTagName('head')[0].appendChild(openSans);\n    openSansAdded = true;\n  }\n  const font = weight + ' ' + size + '/' + height + ' ' + dom.font.value;\n  const fillColor = dom.color.value;\n  const outlineColor = dom.outline.value;\n  const outlineWidth = parseInt(dom.outlineWidth.value, 10);\n\n  return new Text({\n    textAlign: align == '' ? undefined : align,\n    textBaseline: baseline,\n    font: font,\n    text: getText(feature, resolution, dom),\n    fill: new Fill({color: fillColor}),\n    stroke: new Stroke({color: outlineColor, width: outlineWidth}),\n    offsetX: offsetX,\n    offsetY: offsetY,\n    placement: placement,\n    maxAngle: maxAngle,\n    overflow: overflow,\n    rotation: rotation,\n  });\n};\n\n// Polygons\nfunction polygonStyleFunction(feature, resolution) {\n  return new Style({\n    stroke: new Stroke({\n      color: 'blue',\n      width: 1,\n    }),\n    fill: new Fill({\n      color: 'rgba(0, 0, 255, 0.1)',\n    }),\n    text: createTextStyle(feature, resolution, myDom.polygons),\n  });\n}\n\nconst vectorPolygons = new VectorLayer({\n  source: new VectorSource({\n    url: 'data/geojson/polygon-samples.geojson',\n    format: new GeoJSON(),\n  }),\n  style: polygonStyleFunction,\n});\n\n// Lines\nfunction lineStyleFunction(feature, resolution) {\n  return new Style({\n    stroke: new Stroke({\n      color: 'green',\n      width: 2,\n    }),\n    text: createTextStyle(feature, resolution, myDom.lines),\n  });\n}\n\nconst vectorLines = new VectorLayer({\n  source: new VectorSource({\n    url: 'data/geojson/line-samples.geojson',\n    format: new GeoJSON(),\n  }),\n  style: lineStyleFunction,\n});\n\n// Points\nfunction pointStyleFunction(feature, resolution) {\n  return new Style({\n    image: new CircleStyle({\n      radius: 10,\n      fill: new Fill({color: 'rgba(255, 0, 0, 0.1)'}),\n      stroke: new Stroke({color: 'red', width: 1}),\n    }),\n    text: createTextStyle(feature, resolution, myDom.points),\n  });\n}\n\nconst vectorPoints = new VectorLayer({\n  source: new VectorSource({\n    url: 'data/geojson/point-samples.geojson',\n    format: new GeoJSON(),\n  }),\n  style: pointStyleFunction,\n});\n\nconst map = new Map({\n  layers: [\n    new TileLayer({\n      source: new OSM(),\n    }),\n    vectorPolygons,\n    vectorLines,\n    vectorPoints,\n  ],\n  target: 'map',\n  view: new View({\n    center: [-8161939, 6095025],\n    zoom: 8,\n  }),\n});\n\ndocument\n  .getElementById('refresh-points')\n  .addEventListener('click', function () {\n    vectorPoints.setStyle(pointStyleFunction);\n  });\n\ndocument.getElementById('refresh-lines').addEventListener('click', function () {\n  vectorLines.setStyle(lineStyleFunction);\n});\n\ndocument\n  .getElementById('refresh-polygons')\n  .addEventListener('click', function () {\n    vectorPolygons.setStyle(polygonStyleFunction);\n  });\n\n/**\n * @param {number} n The max number of characters to keep.\n * @return {string} Truncated string.\n */\nString.prototype.trunc =\n  String.prototype.trunc ||\n  function (n) {\n    return this.length > n ? this.substr(0, n - 1) + '...' : this.substr(0);\n  };\n\n// https://stackoverflow.com/questions/14484787/wrap-text-in-javascript\nfunction stringDivider(str, width, spaceReplacer) {\n  if (str.length > width) {\n    let p = width;\n    while (p > 0 && str[p] != ' ' && str[p] != '-') {\n      p--;\n    }\n    if (p > 0) {\n      let left;\n      if (str.substring(p, p + 1) == '-') {\n        left = str.substring(0, p + 1);\n      } else {\n        left = str.substring(0, p);\n      }\n      const right = str.substring(p + 1);\n      return left + spaceReplacer + stringDivider(right, width, spaceReplacer);\n    }\n  }\n  return str;\n}\n"],"names":["openSansAdded","myDom","points","text","document","getElementById","align","baseline","rotation","font","weight","size","height","offsetX","offsetY","color","outline","outlineWidth","maxreso","lines","placement","maxangle","overflow","polygons","getText","feature","resolution","dom","type","value","maxResolution","get","trunc","stringDivider","createTextStyle","parseInt","undefined","maxAngle","parseFloat","openSans","createElement","href","rel","getElementsByTagName","appendChild","fillColor","outlineColor","Text","textAlign","textBaseline","fill","Fill","stroke","Stroke","width","polygonStyleFunction","Style","vectorPolygons","VectorLayer","source","VectorSource","url","format","GeoJSON","style","lineStyleFunction","vectorLines","pointStyleFunction","image","CircleStyle","radius","vectorPoints","Map","layers","TileLayer","OSM","target","view","View","center","zoom","str","spaceReplacer","length","p","substring","addEventListener","setStyle","String","prototype","n","this","substr"],"sourceRoot":""}