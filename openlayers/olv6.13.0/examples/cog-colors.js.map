{"version":3,"file":"cog-colors.js","mappings":"qOAIA,IAQMA,EAAgBC,SAASC,eAAe,aAC9CF,EAAcG,MAPU,UASxB,IAAMC,EAAgBH,SAASC,eAAe,aAC9CE,EAAcD,MATU,UAWxB,IAAME,EAAiBJ,SAASC,eAAe,oBACzCI,EAAgBL,SAASC,eAAe,mBAC9CI,EAAcH,QAXW,IAWaI,WAEtC,IAAMC,EAAiBP,SAASC,eAAe,oBACzCO,EAAgBR,SAASC,eAAe,mBAG9C,SAASQ,IAWP,IAVA,IAAMC,EAAY,GAEZC,EAAWZ,EAAcG,MACzBU,EAAWT,EAAcD,MACzBW,EAAQC,OAAOD,MAAM,CAACF,EAAUC,IAAWG,KAAK,OAEhDC,EAAWC,WAAWZ,EAAcH,OAEpCgB,GADWD,WAAWT,EAAcN,OAChBc,GA/BX,GAiCNG,EAAI,EAAGA,GAjCD,KAiCkBA,EAAG,CAClC,IAAMC,EAAQP,EAAMM,EAlCP,IAkCqBE,MAC5BnB,EAAQc,EAAWG,EAAID,EAC7BR,EAAU,QAAD,OAASS,IAAOjB,EACzBQ,EAAU,MAAD,OAAOS,IAAOC,EAAM,GAC7BV,EAAU,QAAD,OAASS,IAAOC,EAAM,GAC/BV,EAAU,OAAD,OAAQS,IAAOC,EAAM,GAEhC,OAAOV,EArBTF,EAAcN,MAdU,GAccI,WAoCtC,I,EAMMgB,EAAS,IAAIC,EAAAA,EAAQ,CACzBC,QAAS,CACP,CAEEC,IAAK,8GACLC,IAAK,KAEP,CAEED,IAAK,8GACLC,IAAK,QAKLC,EAAQ,IAAIC,EAAAA,EAAU,CAC1BC,MAAO,CACLnB,UAAWD,IACXW,MAAO,CAAC,cAAe,CAAC,UAxBf,CACX,IACA,CAAC,IAAK,CAAC,OAAQ,GAAI,CAAC,OAAQ,IAC5B,CAAC,IAAK,CAAC,OAAQ,GAAI,CAAC,OAAQ,MAqBrB,Q,EApCT,WAEE,IADA,IAAMU,EAAQ,GACLX,EAAI,EAAGA,GA9CD,KA8CkBA,EAAG,CAClCW,EAAU,EAAJX,GAAS,CAAC,MAAD,eAAgBA,IAC/B,IAAMY,EAAM,CAAC,MAAD,aAAcZ,IACpBa,EAAQ,CAAC,MAAD,eAAgBb,IACxBc,EAAO,CAAC,MAAD,cAAed,IAC5BW,EAAU,EAAJX,EAAQ,GAAK,CAAC,QAASY,EAAKC,EAAOC,GAE3C,OAAOH,EA2BuCI,G,onBAE9CZ,OAAQA,IAGV,SAASa,IACPR,EAAMS,qBAAqB3B,KAC3BL,EAAeiC,UAAYpB,WAAWZ,EAAcH,OAAOoC,QAAQ,GACnE/B,EAAe8B,UAAYpB,WAAWT,EAAcN,OAAOoC,QAAQ,GAGrEvC,EAAcwC,iBAAiB,QAASJ,GACxChC,EAAcoC,iBAAiB,QAASJ,GACxC9B,EAAckC,iBAAiB,QAASJ,GACxC3B,EAAc+B,iBAAiB,QAASJ,GACxCA,IAEY,IAAIK,EAAAA,EAAI,CAClBC,OAAQ,MACRC,OAAQ,CAACf,GACTgB,KAAMrB,EAAOsB,c","sources":["webpack:///./cog-colors.js"],"sourcesContent":["import GeoTIFF from '../src/ol/source/GeoTIFF.js';\nimport Map from '../src/ol/Map.js';\nimport TileLayer from '../src/ol/layer/WebGLTile.js';\n\nconst segments = 10;\n\nconst defaultMinColor = '#0300AD';\nconst defaultMaxColor = '#00ff00';\n\nconst defaultMinValue = -0.5;\nconst defaultMaxValue = 0.7;\n\nconst minColorInput = document.getElementById('min-color');\nminColorInput.value = defaultMinColor;\n\nconst maxColorInput = document.getElementById('max-color');\nmaxColorInput.value = defaultMaxColor;\n\nconst minValueOutput = document.getElementById('min-value-output');\nconst minValueInput = document.getElementById('min-value-input');\nminValueInput.value = defaultMinValue.toString();\n\nconst maxValueOutput = document.getElementById('max-value-output');\nconst maxValueInput = document.getElementById('max-value-input');\nmaxValueInput.value = defaultMaxValue.toString();\n\nfunction getVariables() {\n  const variables = {};\n\n  const minColor = minColorInput.value;\n  const maxColor = maxColorInput.value;\n  const scale = chroma.scale([minColor, maxColor]).mode('lab');\n\n  const minValue = parseFloat(minValueInput.value);\n  const maxValue = parseFloat(maxValueInput.value);\n  const delta = (maxValue - minValue) / segments;\n\n  for (let i = 0; i <= segments; ++i) {\n    const color = scale(i / segments).rgb();\n    const value = minValue + i * delta;\n    variables[`value${i}`] = value;\n    variables[`red${i}`] = color[0];\n    variables[`green${i}`] = color[1];\n    variables[`blue${i}`] = color[2];\n  }\n  return variables;\n}\n\nfunction colors() {\n  const stops = [];\n  for (let i = 0; i <= segments; ++i) {\n    stops[i * 2] = ['var', `value${i}`];\n    const red = ['var', `red${i}`];\n    const green = ['var', `green${i}`];\n    const blue = ['var', `blue${i}`];\n    stops[i * 2 + 1] = ['color', red, green, blue];\n  }\n  return stops;\n}\n\nconst ndvi = [\n  '/',\n  ['-', ['band', 2], ['band', 1]],\n  ['+', ['band', 2], ['band', 1]],\n];\n\nconst source = new GeoTIFF({\n  sources: [\n    {\n      // visible red, band 1 in the style expression above\n      url: 'https://sentinel-cogs.s3.us-west-2.amazonaws.com/sentinel-s2-l2a-cogs/2020/S2A_36QWD_20200701_0_L2A/B04.tif',\n      max: 10000,\n    },\n    {\n      // near infrared, band 2 in the style expression above\n      url: 'https://sentinel-cogs.s3.us-west-2.amazonaws.com/sentinel-s2-l2a-cogs/2020/S2A_36QWD_20200701_0_L2A/B08.tif',\n      max: 10000,\n    },\n  ],\n});\n\nconst layer = new TileLayer({\n  style: {\n    variables: getVariables(),\n    color: ['interpolate', ['linear'], ndvi, ...colors()],\n  },\n  source: source,\n});\n\nfunction update() {\n  layer.updateStyleVariables(getVariables());\n  minValueOutput.innerText = parseFloat(minValueInput.value).toFixed(1);\n  maxValueOutput.innerText = parseFloat(maxValueInput.value).toFixed(1);\n}\n\nminColorInput.addEventListener('input', update);\nmaxColorInput.addEventListener('input', update);\nminValueInput.addEventListener('input', update);\nmaxValueInput.addEventListener('input', update);\nupdate();\n\nconst map = new Map({\n  target: 'map',\n  layers: [layer],\n  view: source.getView(),\n});\n"],"names":["minColorInput","document","getElementById","value","maxColorInput","minValueOutput","minValueInput","toString","maxValueOutput","maxValueInput","getVariables","variables","minColor","maxColor","scale","chroma","mode","minValue","parseFloat","delta","i","color","rgb","source","GeoTIFF","sources","url","max","layer","TileLayer","style","stops","red","green","blue","colors","update","updateStyleVariables","innerText","toFixed","addEventListener","Map","target","layers","view","getView"],"sourceRoot":""}