{"version":3,"file":"mapbox-layer.js","mappings":"8KASMA,EAAS,EAAE,KAAM,MAGjBC,EAAQ,IAAIC,SAASC,IAAI,CAC7BC,MAAO,wFACPC,oBAAoB,EACpBC,SAAS,EACTN,OAAQA,EACRO,UAAW,MACXC,iBAAiB,EACjBC,SAAS,EACTC,YAAY,EACZC,aAAa,EACbC,UAAU,EACVC,iBAAiB,EACjBC,YAAY,EACZC,iBAAiB,IAGbC,EAAU,IAAIC,EAAAA,EAAM,CACxBC,OAAQ,SAAUC,GAChB,IAAMC,EAASnB,EAAMoB,YACfC,EAAYH,EAAWG,UAEvBC,EAAUP,EAAQQ,aACxBJ,EAAOhB,MAAMqB,QAAUF,EAAU,QAAU,OAC3CH,EAAOhB,MAAMsB,SAAW,WAExB,IAAMC,EAAUX,EAAQY,aACxBR,EAAOhB,MAAMuB,QAAUA,EAGvB,IAAME,EAAWP,EAAUO,SAiB3B,OAhBA5B,EAAM6B,OAAO,CACX9B,QAAQ+B,EAAAA,EAAAA,IAAST,EAAUtB,QAC3BgC,KAAMV,EAAUU,KAAO,EACvBC,QAAsB,KAAXJ,EAAkBK,KAAKC,GAClCC,SAAS,IAMPnC,EAAMoC,SACRpC,EAAMoC,OAAOC,SACbrC,EAAMoC,OAAS,MAEjBpC,EAAMsC,UAECnB,GAEToB,OAAQ,IAAIC,EAAAA,EAAO,CACjBC,aAAc,CACZ,+EACA,0GAKAC,EAAS,IAAIC,EAAAA,EAAa,CAC9BJ,OAAQ,IAAIK,EAAAA,EAAa,CACvBC,IAAK,oCACLC,OAAQ,IAAIC,EAAAA,IAEdC,OAAQ,SAAUC,GAChB,OAAOA,EAAQC,IAAI,cAAgB,KAErCC,OAAQ,GACRC,KAAM,KAGI,IAAIlD,EAAAA,EAAI,CAClBmD,OAAQ,MACRC,KAAM,IAAIC,EAAAA,GAAK,CACbxD,QAAQyD,EAAAA,EAAAA,IAAWzD,GACnBgC,KAAM,IAER0B,OAAQ,CAAC1C,EAAS2B,O","sources":["webpack:///./mapbox-layer.js"],"sourcesContent":["import GeoJSON from '../src/ol/format/GeoJSON.js';\nimport HeatmapLayer from '../src/ol/layer/Heatmap.js';\nimport Layer from '../src/ol/layer/Layer.js';\nimport Map from '../src/ol/Map.js';\nimport Source from '../src/ol/source/Source.js';\nimport VectorSource from '../src/ol/source/Vector.js';\nimport View from '../src/ol/View.js';\nimport {fromLonLat, toLonLat} from '../src/ol/proj.js';\n\nconst center = [-98.8, 37.9];\nconst key = 'get_your_own_D6rA4zTHduk6KOKTXzGB';\n\nconst mbMap = new mapboxgl.Map({\n  style: 'https://api.maptiler.com/maps/bright/style.json?key=' + key,\n  attributionControl: false,\n  boxZoom: false,\n  center: center,\n  container: 'map',\n  doubleClickZoom: false,\n  dragPan: false,\n  dragRotate: false,\n  interactive: false,\n  keyboard: false,\n  pitchWithRotate: false,\n  scrollZoom: false,\n  touchZoomRotate: false,\n});\n\nconst mbLayer = new Layer({\n  render: function (frameState) {\n    const canvas = mbMap.getCanvas();\n    const viewState = frameState.viewState;\n\n    const visible = mbLayer.getVisible();\n    canvas.style.display = visible ? 'block' : 'none';\n    canvas.style.position = 'absolute';\n\n    const opacity = mbLayer.getOpacity();\n    canvas.style.opacity = opacity;\n\n    // adjust view parameters in mapbox\n    const rotation = viewState.rotation;\n    mbMap.jumpTo({\n      center: toLonLat(viewState.center),\n      zoom: viewState.zoom - 1,\n      bearing: (-rotation * 180) / Math.PI,\n      animate: false,\n    });\n\n    // cancel the scheduled update & trigger synchronous redraw\n    // see https://github.com/mapbox/mapbox-gl-js/issues/7893#issue-408992184\n    // NOTE: THIS MIGHT BREAK IF UPDATING THE MAPBOX VERSION\n    if (mbMap._frame) {\n      mbMap._frame.cancel();\n      mbMap._frame = null;\n    }\n    mbMap._render();\n\n    return canvas;\n  },\n  source: new Source({\n    attributions: [\n      '<a href=\"https://www.maptiler.com/copyright/\" target=\"_blank\">© MapTiler</a>',\n      '<a href=\"https://www.openstreetmap.org/copyright\" target=\"_blank\">© OpenStreetMap contributors</a>',\n    ],\n  }),\n});\n\nconst cities = new HeatmapLayer({\n  source: new VectorSource({\n    url: 'data/geojson/world-cities.geojson',\n    format: new GeoJSON(),\n  }),\n  weight: function (feature) {\n    return feature.get('population') / 1e7;\n  },\n  radius: 15,\n  blur: 15,\n});\n\nconst map = new Map({\n  target: 'map',\n  view: new View({\n    center: fromLonLat(center),\n    zoom: 4,\n  }),\n  layers: [mbLayer, cities],\n});\n"],"names":["center","mbMap","mapboxgl","Map","style","attributionControl","boxZoom","container","doubleClickZoom","dragPan","dragRotate","interactive","keyboard","pitchWithRotate","scrollZoom","touchZoomRotate","mbLayer","Layer","render","frameState","canvas","getCanvas","viewState","visible","getVisible","display","position","opacity","getOpacity","rotation","jumpTo","toLonLat","zoom","bearing","Math","PI","animate","_frame","cancel","_render","source","Source","attributions","cities","HeatmapLayer","VectorSource","url","format","GeoJSON","weight","feature","get","radius","blur","target","view","View","fromLonLat","layers"],"sourceRoot":""}