{"version":3,"file":"icon-scale.js","mappings":"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","sources":["webpack:///./icon-scale.js"],"sourcesContent":["import Feature from '../src/ol/Feature.js';\nimport Map from '../src/ol/Map.js';\nimport Overlay from '../src/ol/Overlay.js';\nimport Point from '../src/ol/geom/Point.js';\nimport TileJSON from '../src/ol/source/TileJSON.js';\nimport VectorSource from '../src/ol/source/Vector.js';\nimport View from '../src/ol/View.js';\nimport {Icon, Style, Text} from '../src/ol/style.js';\nimport {Tile as TileLayer, Vector as VectorLayer} from '../src/ol/layer.js';\nimport {fromLonLat} from '../src/ol/proj.js';\nimport {getVectorContext} from '../src/ol/render.js';\n\nconst rasterLayer = new TileLayer({\n  source: new TileJSON({\n    url: 'https://a.tiles.mapbox.com/v3/aj.1x1-degrees.json?secure=1',\n    crossOrigin: '',\n  }),\n});\n\nconst iconFeature = new Feature({\n  geometry: new Point(fromLonLat([0, -10])),\n  name: 'Fish.1',\n});\n\nconst feature1 = new Feature({\n  geometry: new Point(fromLonLat([0, -10])),\n  name: 'Fish.1 Island',\n});\n\nconst feature2 = new Feature({\n  geometry: new Point(fromLonLat([-30, 10])),\n  name: 'Fish.2 Island',\n});\n\nconst iconStyle = new Style({\n  image: new Icon({\n    anchor: [0.5, 0.9],\n    src: 'data/fish.png',\n    crossOrigin: '',\n    scale: [0, 0],\n    rotation: Math.PI / 4,\n  }),\n  text: new Text({\n    text: 'FISH\\nTEXT',\n    scale: [0, 0],\n    rotation: Math.PI / 4,\n    textAlign: 'center',\n    textBaseline: 'top',\n  }),\n});\n\nlet i = 0;\nlet j = 45;\n\niconFeature.setStyle(function () {\n  const x = Math.sin((i * Math.PI) / 180) * 3;\n  const y = Math.sin((j * Math.PI) / 180) * 4;\n  iconStyle.getImage().setScale([x, y]);\n  iconStyle.getText().setScale([x, y]);\n  return iconStyle;\n});\n\nrasterLayer.on('postrender', function (event) {\n  const vectorContext = getVectorContext(event);\n  const x = Math.cos((i * Math.PI) / 180) * 3;\n  const y = Math.cos((j * Math.PI) / 180) * 4;\n  iconStyle.getImage().setScale([x, y]);\n  iconStyle.getText().setScale([x, y]);\n  vectorContext.drawFeature(feature2, iconStyle);\n});\n\nconst vectorSource = new VectorSource({\n  features: [iconFeature, feature1, feature2],\n});\n\nconst vectorLayer = new VectorLayer({\n  source: vectorSource,\n});\n\nconst map = new Map({\n  layers: [rasterLayer, vectorLayer],\n  target: document.getElementById('map'),\n  view: new View({\n    center: fromLonLat([-15, 0]),\n    zoom: 3,\n  }),\n});\n\nsetInterval(function () {\n  i = (i + 4) % 360;\n  j = (j + 5) % 360;\n  vectorSource.changed();\n}, 1000);\n\nconst element = document.getElementById('popup');\n\nconst popup = new Overlay({\n  element: element,\n  positioning: 'bottom-center',\n  stopEvent: false,\n});\nmap.addOverlay(popup);\n\n// display popup on click\nmap.on('click', function (evt) {\n  const feature = map.forEachFeatureAtPixel(evt.pixel, function (feature) {\n    return feature;\n  });\n  $(element).popover('dispose');\n  if (feature) {\n    popup.setPosition(evt.coordinate);\n    $(element).popover({\n      placement: 'top',\n      html: true,\n      animation: false,\n      content: feature.get('name'),\n    });\n    $(element).popover('show');\n  }\n});\n\n// change mouse cursor when over marker\nmap.on('pointermove', function (e) {\n  const pixel = map.getEventPixel(e.originalEvent);\n  const hit = map.hasFeatureAtPixel(pixel);\n  map.getTarget().style.cursor = hit ? 'pointer' : '';\n});\n// Close the popup when the map is moved\nmap.on('movestart', function () {\n  $(element).popover('dispose');\n});\n"],"names":["rasterLayer","TileLayer","source","TileJSON","url","crossOrigin","iconFeature","Feature","geometry","Point","fromLonLat","name","feature1","feature2","iconStyle","Style","image","Icon","anchor","src","scale","rotation","Math","PI","text","Text","textAlign","textBaseline","i","j","setStyle","x","sin","y","getImage","setScale","getText","on","event","vectorContext","getVectorContext","cos","drawFeature","vectorSource","VectorSource","features","vectorLayer","VectorLayer","map","Map","layers","target","document","getElementById","view","View","center","zoom","setInterval","changed","element","popup","Overlay","positioning","stopEvent","addOverlay","evt","feature","forEachFeatureAtPixel","pixel","$","popover","setPosition","coordinate","placement","html","animation","content","get","e","getEventPixel","originalEvent","hit","hasFeatureAtPixel","getTarget","style","cursor"],"sourceRoot":""}